<%= render Panda::Core::Admin::ContainerComponent.new do |component| %>
  <% component.with_heading_slot(text: redirect_record.origin_path, level: 1) do |heading| %>
    <% heading.with_button(
      action: :delete,
      text: "Delete",
      href: admin_cms_redirect_path(redirect_record),
      data: { turbo_method: :delete, turbo_confirm: "Are you sure you want to delete this redirect?" }
    ) %>
  <% end %>

  <%= panda_form_with model: redirect_record, url: admin_cms_redirect_path(redirect_record), method: :patch do |f| %>
    <%= render Panda::Core::Admin::FormErrorComponent.new(model: redirect_record) %>

    <%= render Panda::Core::Admin::PanelComponent.new do |panel| %>
      <% panel.with_heading_slot { "Redirect Settings" } %>

      <div class="space-y-4">
        <%= f.text_field :origin_path, placeholder: "/old-page" %>
        <%= f.text_field :destination_path, placeholder: "/new-page" %>
        <%= f.select :status_code, [["301 — Permanent", 301], ["302 — Temporary", 302]], { label: "Status Code" } %>
      </div>
    <% end %>

    <%= render Panda::Core::Admin::PanelComponent.new do |panel| %>
      <% panel.with_heading_slot { "Statistics" } %>

      <div class="grid grid-cols-2 gap-4">
        <div>
          <span class="text-sm text-gray-500">Total Visits</span>
          <p class="text-lg font-semibold"><%= redirect_record.visits %></p>
        </div>
        <div>
          <span class="text-sm text-gray-500">Last Visited</span>
          <p class="text-lg font-semibold">
            <%= redirect_record.last_visited_at ? "#{time_ago_in_words(redirect_record.last_visited_at)} ago" : "Never" %>
          </p>
        </div>
      </div>
    <% end %>

    <%= render Panda::Core::Admin::FormFooterComponent.new(submit_text: "Save Redirect") %>

    <%= link_to "Delete", admin_cms_redirect_path(redirect_record),
      data: { turbo_method: :delete, turbo_confirm: "Are you sure you want to delete this redirect?" },
      class: "text-red-600 hover:text-red-800" %>
  <% end %>
<% end %>
