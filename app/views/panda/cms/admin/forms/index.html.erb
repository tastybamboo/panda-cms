<%= render Panda::Core::Admin::ContainerComponent.new do |component| %>
  <% component.heading(text: "Forms", level: 1, icon: "fa-solid fa-inbox") do |heading| %>
    <% heading.button(action: :add, text: "New Form", href: new_admin_cms_form_path) %>
  <% end %>

  <%= render Panda::Core::Admin::TableComponent.new(term: "form", rows: forms, icon: "fa-solid fa-inbox") do |table| %>
    <% table.column("Name") { |form| block_link_to form.name, admin_cms_form_path(form) } %>
    <% table.column("Status") do |form| %>
      <% status = form.status || "active" %>
      <% status_symbol = status == "active" ? :active : (status == "draft" ? :pending : :inactive) %>
      <%= render Panda::Core::Admin::TagComponent.new(status: status_symbol, text: status.titleize) %>
    <% end %>
    <% table.column("Fields") { |form| form.form_fields.count } %>
    <% table.column("Submissions") { |form| form.submission_count } %>
    <% table.column("Last Submission") do |form| %>
      <%= "#{time_ago_in_words(form.form_submissions&.last&.created_at)} ago" if form.form_submissions&.last %>
    <% end %>
    <% table.column("") do |form| %>
      <%= link_to "Edit", edit_admin_cms_form_path(form), class: "text-mid hover:text-mid/80 mr-3" %>
      <%= link_to "Delete", admin_cms_form_path(form),
        data: { turbo_method: :delete, turbo_confirm: "Are you sure you want to delete this form?" },
        class: "text-red-600 hover:text-red-800" %>
    <% end %>
  <% end %>
<% end %>
