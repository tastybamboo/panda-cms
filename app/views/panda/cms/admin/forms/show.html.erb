<%= render Panda::Core::Admin::ContainerComponent.new do |component| %>
  <% component.with_heading_slot(text: "#{form.name} Submissions", level: 1) do |heading| %>
    <% heading.with_button(text: "Edit Form", href: edit_admin_cms_form_path(form), icon: "fa-solid fa-pen") %>
  <% end %>

  <%= render Panda::Core::Admin::TableComponent.new(term: "submission", rows: submissions) do |table| %>
    <% fields.each do |field, title, field_type| %>
      <% table.column(title) do |submission| %>
        <% value = submission.data[field] %>
        <% if field_type == "signature" && value.present? && value.start_with?("data:image") %>
          <img src="<%= value %>" alt="Signature" style="max-width: 200px; max-height: 80px; border: 1px solid #e5e7eb;">
        <% elsif field == "email" || field == "email_address" %>
          <a href="mailto:<%= value %>" class="border-b border-gray-500 hover:text-gray-900"><%= value %></a>
        <% else %>
          <%= simple_format(value) %>
        <% end %>
      <% end %>
    <% end %>

    <% table.column("Submitted") do |submission| %>
      <%= time_ago_in_words(submission.created_at) %> ago
    <% end %>
  <% end %>
<% end %>
