<%= render Panda::Core::Admin::ContainerComponent.new(full_height: true) do |component| %>
  <% component.heading(text: "#{page.title}", level: 1) %>
  <% component.with_slideover(title: "Page Details") do %>
    <%= panda_cms_form_with model: page, url: admin_cms_page_path, method: :put do |f| %>
      <%= f.text_field :title %>
      <%= f.text_field :template, value: template.name, readonly: true, class: "read-only:bg-gray-100" %>
      <%= f.select :status, options_for_select([["Active", "active"], ["Draft", "draft"], ["Hidden", "hidden"], ["Archived", "archived"]], selected: page.status) %>
      <% if page.page_type.in?(["system", "posts"]) %>
        <%= f.text_field :page_type, value: page.page_type.humanize, readonly: true, class: "read-only:bg-gray-100" %>
      <% else %>
        <%= f.select :page_type, options_for_select([["Active", "standard"], ["Hidden", "hidden"], ["Code", "code"]], selected: page.page_type) %>
      <% end %>
      <%= f.submit "Save" %>
    <% end %>
  <% end %>
  <div id="successMessage" class="hidden">
    <%= render Panda::Core::Admin::FlashMessageComponent.new(kind: :success, message: "This page was successfully updated!", temporary: false) %>
  </div>
  <div id="errorMessage" class="hidden">
    <%= render Panda::Core::Admin::FlashMessageComponent.new(kind: :error, message: "There was an error updating this page.", temporary: false) %>
  </div>
  <div class="grid grid-cols-2 mb-4 -mt-5">
    <div>
      <a class="inline-block mb-2 text-sm text-black/60" target="_blank" href="<%= @page.path %>"><%= @page.path %> <i class="ml-2 fa-solid fa-arrow-up-right-from-square"></i></a>
    </div>
    <div class="flex justify-end">
      <%= render Panda::Core::Admin::ButtonComponent.new(text: "Save Changes", action: :save, icon: "check", link: "#", size: :regular, id: "saveEditableButton") %>
    </div>
  </div>

  <%= content_tag :iframe, nil,
      src: "#{page.path}?embed_id=#{page.id}",
      class: "p-0 m-0 w-full h-full border border-slate-200",
      style: "min-height: 500px; width: 100%; height: 100%;",
      id: "editablePageFrame",
      data: {
        controller: "editor-iframe",
        editor_iframe_page_id_value: @page.id,
        editor_iframe_admin_path_value: "#{admin_cms_dashboard_url}",
        editor_iframe_autosave_value: false
      } %>
<% end %>
